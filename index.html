<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Easy Chinese</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: auto; background: #fdfdfd; color: #333;}
    .dark { background: #222; color: #eee; }
    h1, h2 { text-align: center; }
    select, button, input { margin: 5px 0; padding: 8px; }
    .locked { background:#ffdddd; padding:10px; text-align:center; cursor:pointer; }
    #xpBar { background: orange; height: 10px; width:0; margin-top:5px;}
    .chatbox { margin-top:1em; }
    .chatbox div { margin: 4px 0; }
    canvas { margin-top: 20px; }
  </style>
</head>
<body>

<h1>Easy Chinese</h1>
<p style="text-align:center"><em>Master Chinese from HSK 1 to 9 effortlessly!</em></p>

<button onclick="toggleDarkMode()">Toggle Dark Mode</button>
<button onclick="buyCoffee()">â˜• Buy Me A Coffee</button>

<h3>Your Streak: <span id="streak">0</span> ðŸ”¥</h3>
<h3>XP: <span id="xp">0</span></h3>
<div id="xpBar"></div>

<hr/>

<h2>Daily Boost</h2>
<p id="dailyWord"></p>
<p id="dailyGrammar"></p>

<hr/>

<h2>Choose HSK Level</h2>
<select id="levelSelect" onchange="changeLevel()">
  <option value="1">HSK 1</option>
  <option value="2">HSK 2</option>
  <option value="3">HSK 3</option>
  <option value="4">HSK 4</option>
  <option value="5">HSK 5</option>
  <option value="6">HSK 6 (PRO)</option>
  <option value="7">HSK 7 (PRO)</option>
  <option value="8">HSK 8 (PRO)</option>
  <option value="9">HSK 9 (PRO)</option>
</select>

<h2>Vocabulary</h2>
<div id="vocab"></div>

<h2>Grammar</h2>
<div id="grammar"></div>

<h2>Conversations</h2>
<div id="conversation"></div>

<h2>Quiz</h2>
<div id="quiz"></div>

<h2>Your Progress</h2>
<canvas id="progressChart" width="400" height="200"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const vocabData = {
  1: ["ä½ å¥½ (nÇ hÇŽo) - hello", "è°¢è°¢ (xiÃ¨xiÃ¨) - thank you"],
  2: ["å†è§ (zÃ ijiÃ n) - goodbye", "è¯·é—® (qÇngwÃ¨n) - may I ask"],
  3: ["å› ä¸º (yÄ«nwÃ¨i) - because", "ä½†æ˜¯ (dÃ nshÃ¬) - but"],
  4: ["è™½ç„¶ (suÄ«rÃ¡n) - although", "ä¸ºäº† (wÃ¨ile) - in order to"],
  5: ["ç«Ÿç„¶ (jÃ¬ngrÃ¡n) - unexpectedly", "æ— è®º (wÃºlÃ¹n) - no matter"],
  6: ["ä¸Žæ­¤åŒæ—¶ (yÃºtÃ³ngshÃ­) - meanwhile", "å°šæœª (shÃ ngwÃ¨i) - not yet"],
  7: ["é‰´äºŽ (jiÃ nyÃº) - in view of", "å€˜è‹¥ (tÇŽngruÃ²) - if"],
  8: ["æ¯‹åº¸ç½®ç–‘ (wÃºyÅng zhÃ¬yÃ­) - undoubtedly", "ä½•å° (hÃ©chÃ¡ng) - ever"],
  9: ["å²‚ä¸æ˜¯ (qÇ bÃº shÃ¬) - wouldn't it be", "å°šä¸” (shÃ ngqiÄ›) - even"]
};

const grammarData = {
  1: ["S + æ˜¯ + N", "S + æœ‰ + N"],
  2: ["S + æ­£åœ¨ + V", "S + è¦ + V"],
  3: ["S + ä¸€è¾¹ + V1 + ä¸€è¾¹ + V2", "S + è™½ç„¶...ä½†æ˜¯..."],
  4: ["S + ä¸ºäº† + V", "S + å…ˆ...ç„¶åŽ..."],
  5: ["S + æ—¢ç„¶...å°±...", "S + ä¸æ˜¯...è€Œæ˜¯..."],
  6: ["S + å°½ç®¡...è¿˜æ˜¯...", "S + å®å¯...ä¹Ÿä¸..."],
  7: ["S + åªè¦...å°±...", "S + å³ä½¿...ä¹Ÿ..."],
  8: ["S + åè€Œ...", "S + ä½•å†µ..."],
  9: ["S + å¹¶éž...", "S + å°šä¸”...æ›´ä½•å†µ..."]
};

const conversationsData = {
  1: ["A: ä½ å¥½ï¼ B: ä½ å¥½ï¼", "A: è°¢è°¢ä½ ï¼ B: ä¸å®¢æ°”ï¼"],
  2: ["A: è¯·é—®ï¼Œè¿™é‡Œæœ‰äººå—ï¼Ÿ B: æ²¡æœ‰ï¼Œä½ åå§ã€‚"],
  3: ["A: ä½ ä¸ºä»€ä¹ˆå–œæ¬¢è¿™é‡Œï¼Ÿ B: å› ä¸ºå¾ˆå®‰é™ã€‚"],
  4: ["A: ä½ å…ˆåŽ»ï¼Œæˆ‘ç­‰ä¼šæ¥ã€‚ B: å¥½çš„ã€‚"],
  5: ["A: æ—¢ç„¶ä½ æ¥äº†ï¼Œå°±ä¸€èµ·åƒé¥­å§ã€‚"],
  6: ["A: å°½ç®¡å¾ˆéš¾ï¼Œä»–è¿˜æ˜¯åšæŒäº†ä¸‹æ¥ã€‚"],
  7: ["A: åªè¦åŠªåŠ›ï¼Œå°±ä¼šæˆåŠŸã€‚"],
  8: ["A: ä»–ä¸ä½†ä¸ç”Ÿæ°”ï¼Œåè€Œç¬‘äº†ã€‚"],
  9: ["A: è¿™å°šä¸”å¦‚æ­¤ï¼Œæ›´ä½•å†µå…¶ä»–å‘¢ï¼Ÿ"]
};

const chatbotReplies = {
  1: [{cn:"ä½ å¥½ï¼", en:"Hello!"}, {cn:"ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ", en:"What's your name?"}],
  2: [{cn:"è¯·é—®ä½ å‡ å²ï¼Ÿ", en:"How old are you?"}],
  3: [{cn:"å› ä¸ºæˆ‘å–œæ¬¢ä¸­æ–‡ã€‚", en:"Because I like Chinese."}],
  4: [{cn:"ä½ å…ˆè¯´ï¼Œç„¶åŽæˆ‘å›žç­”ã€‚", en:"You speak first, then I'll answer."}],
  5: [{cn:"æ—¢ç„¶ä½ å†³å®šäº†ï¼Œå°±åŽ»åšå§ã€‚", en:"Since you've decided, go for it."}],
  6: [{cn:"å°½ç®¡å¾ˆéš¾ï¼Œæˆ‘è¿˜æ˜¯å­¦ä¸‹åŽ»äº†ã€‚", en:"Though it's hard, I kept learning."}],
  7: [{cn:"åªè¦ä½ åŠªåŠ›ï¼Œå°±ä¸€å®šæˆåŠŸã€‚", en:"As long as you work hard, you'll succeed."}],
  8: [{cn:"ä»–ä¸ä½†ä¸ç”Ÿæ°”ï¼Œåè€Œç¬‘äº†ã€‚", en:"Not only did he not get angry, he even smiled."}],
  9: [{cn:"å°šä¸”å¦‚æ­¤ï¼Œæ›´ä½•å†µå…¶ä»–ã€‚", en:"If even this is so, how about the rest?"}]
};

let xp = 0;
let streak = 0;
let lastVisit = localStorage.getItem("lastVisit") || "";
let today = new Date().toISOString().slice(0,10);

if (today !== lastVisit) {
  streak = parseInt(localStorage.getItem("streak") || "0") + 1;
  localStorage.setItem("streak", streak);
  localStorage.setItem("lastVisit", today);
}
document.getElementById("streak").innerText = streak;

function toggleDarkMode() {
  document.body.classList.toggle("dark");
}

function buyCoffee() {
  alert("Thanks for supporting us! Redirecting to BuyMeACoffee...");
  window.open("https://buymeacoffee.com/yourusername", "_blank");
}

function upgradePro() {
  alert("Upgrade to Easy Chinese Pro for $5/month to unlock all HSK levels, quizzes & coaching!");
}

function changeLevel() {
  const level = parseInt(document.getElementById("levelSelect").value);
  if (level >= 6) {
    document.getElementById("vocab").innerHTML = `<div class="locked" onclick="upgradePro()">ðŸ”’ Premium content. Click to upgrade.</div>`;
    document.getElementById("grammar").innerHTML = `<div class="locked" onclick="upgradePro()">ðŸ”’ Premium content. Click to upgrade.</div>`;
    document.getElementById("conversation").innerHTML = `<div class="locked" onclick="upgradePro()">ðŸ”’ Premium content. Click to upgrade.</div>`;
    document.getElementById("quiz").innerHTML = `<div class="locked" onclick="upgradePro()">ðŸ”’ Premium content. Click to upgrade.</div>`;
  } else {
    updateContent(level);
  }
}

function updateContent(level) {
  let v = vocabData[level].map(item=>`<li>${item}</li>`).join("");
  let g = grammarData[level].map(item=>`<li>${item}</li>`).join("");
  let c = conversationsData[level].map(item=>`<li>${item}</li>`).join("");
  document.getElementById("vocab").innerHTML = `<ul>${v}</ul>`;
  document.getElementById("grammar").innerHTML = `<ul>${g}</ul>`;
  document.getElementById("conversation").innerHTML = `<ul>${c}</ul>
    <div class="chatbox">
      <input id="chatInput" placeholder="Say something..." style="width:70%; padding:0.5em;">
      <button onclick="talkBot()">ðŸ’¬ Send</button>
      <div id="chatOutput" style="margin-top:0.5em;"></div>
    </div>`;
  document.getElementById("quiz").innerHTML = `<button onclick="addXP()">Take a quick quiz (+10 XP)</button>`;
}

function addXP() {
  xp += 10;
  localStorage.setItem("xp", xp);
  document.getElementById("xp").innerText = xp;
  document.getElementById("xpBar").style.width = xp + "px";
  drawChart();
}

function dailyTip() {
  let level = Math.ceil(Math.random()*9);
  let word = vocabData[level][0];
  let grammar = grammarData[level][0];
  document.getElementById("dailyWord").innerText = `Today's word (HSK ${level}): ${word}`;
  document.getElementById("dailyGrammar").innerText = `Today's grammar: ${grammar}`;
}

function drawChart() {
  let ctx = document.getElementById('progressChart').getContext('2d');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: Array(10).fill("").map((_,i)=>i+1),
      datasets: [{
        label: 'XP Growth',
        data: Array(10).fill(0).map(()=>Math.floor(Math.random()*xp)),
        borderColor: 'orange',
        tension: 0.3
      }]
    },
    options: { responsive: true, plugins: { legend: { display: false }}}
  });
}

function talkBot() {
  let userText = document.getElementById("chatInput").value;
  let level = parseInt(document.getElementById("levelSelect").value);
  let botSet = chatbotReplies[level] || chatbotReplies[1];
  let reply = botSet[Math.floor(Math.random()*botSet.length)];
  let outputDiv = document.getElementById("chatOutput");
  outputDiv.innerHTML += `<div><strong>You:</strong> ${userText}</div>`;
  outputDiv.innerHTML += `<div><strong>Bot:</strong> ${reply.cn} <small>(${reply.en})</small></div>`;
  document.getElementById("chatInput").value = "";
}

xp = parseInt(localStorage.getItem("xp") || "0");
document.getElementById("xp").innerText = xp;
document.getElementById("xpBar").style.width = xp + "px";
dailyTip();
drawChart();
changeLevel();
</script>
</body>
</html>